<?xml version='1.0' encoding='utf-8'?>
<SQLResource version='1'>
 
<query name='PARA_COMPANY_Q'><![CDATA[
    SELECT  ${SCH_COMP_CD}      AS COMP_CD
         ,  MAX(CASE WHEN PM.PARA_CD = '2001' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2001
         ,  MAX(CASE WHEN PM.PARA_CD = '2002' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2002
         ,  MAX(CASE WHEN PM.PARA_CD = '2003' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2003
         ,  MAX(CASE WHEN PM.PARA_CD = '2004' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2004
         ,  MAX(CASE WHEN PM.PARA_CD = '2005' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2005
         ,  MAX(CASE WHEN PM.PARA_CD = '2006' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2006
         ,  MAX(CASE WHEN PM.PARA_CD = '2007' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2007
         ,  MAX(CASE WHEN PM.PARA_CD = '2008' THEN NVL(PC.PARA_VAL, PM.PARA_DEFAULT) END)   AS COMPANY_2008
      FROM  PARA_MST        PM
         ,  PARA_COMPANY    PC
     WHERE  PM.PARA_CD      = PC.PARA_CD(+)
       AND  PM.PARA_TABLE   = 'PARA_COMPANY'
       AND  PM.USE_YN       = 'Y'
       AND  PC.COMP_CD(+)   = ${SCH_COMP_CD}
       AND  PC.USE_YN(+)    = 'Y'
     GROUP  BY ${SCH_COMP_CD}
]]></query>

<!-- 브랜드별 파라미터 정보 조회 -->
<query name='PARA_BRAND_Q'><![CDATA[
    SELECT  ${SCH_COMP_CD}      AS COMP_CD
         ,  ${SCH_BRAND_CD}     AS BRAND_CD
         ,  MAX(CASE WHEN PM.PARA_CD = '1001' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS RCP_DIV
         ,  MAX(CASE WHEN PM.PARA_CD = '1002' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS PROD_UNIT_DIV
         ,  MAX(CASE WHEN PM.PARA_CD = '1003' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS ORD_CLASS
         ,  MAX(CASE WHEN PM.PARA_CD = '1004' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS CUST_CNT_DIV
         ,  MAX(CASE WHEN PM.PARA_CD = '1005' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS COST_DIV
         ,  MAX(CASE WHEN PM.PARA_CD = '1006' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS AUTO_CF_YN
         ,  MAX(CASE WHEN PM.PARA_CD = '1007' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS IN_COST_DIV
         ,  MAX(CASE WHEN PM.PARA_CD = '1008' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS RTN_STOCK_YN
         ,  MAX(CASE WHEN PM.PARA_CD = '1009' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS ORD_QTY_FORMAT
         ,  MAX(CASE WHEN PM.PARA_CD = '1010' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS ORD_OVER_RECV_YN
         ,  MAX(CASE WHEN PM.PARA_CD = '1011' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS LEAD_TIME_USE_YN
         ,  MAX(CASE WHEN PM.PARA_CD = '1012' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS DEFAULT_LEAD_TIME
         ,  MAX(CASE WHEN PM.PARA_CD = '1013' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS EXCEPT_SUNDAY_YN
         ,  MAX(CASE WHEN PM.PARA_CD = '1014' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS RESV_ORD_YN
         ,  MAX(CASE WHEN PM.PARA_CD = '1015' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS ALERT_STD_RATE
         ,  MAX(CASE WHEN PM.PARA_CD = '1021' THEN NVL(PB.PARA_VAL, PM.PARA_DEFAULT) END)   AS STOCK_QTY_FORMAT
      FROM  PARA_MST    PM
         ,  PARA_BRAND  PB
     WHERE  PM.PARA_CD      = PB.PARA_CD(+)
       AND  PM.PARA_TABLE   = 'PARA_BRAND'
       AND  PM.USE_YN       = 'Y'
       AND  PB.COMP_CD(+)   = ${SCH_COMP_CD}
       AND  PB.BRAND_CD(+)  = ${SCH_BRAND_CD}
       AND  PB.USE_YN(+)    = 'Y'
     GROUP  BY ${SCH_COMP_CD}, ${SCH_BRAND_CD}
]]></query>

</SQLResource>

